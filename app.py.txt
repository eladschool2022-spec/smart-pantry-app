import streamlit as st
import google.generativeai as genai
from PIL import Image
import io

# --- 专转 注 ---
st.set_page_config(page_title="SmartPantry AI", page_icon="", layout="centered")

# --- 注爪 (CSS) ---
st.markdown("""
    <style>
    .main { background-color: #f9fbfd; }
    .stButton>button { 
        width: 100%; 
        border-radius: 12px; 
        height: 3em; 
        background-color: #27ae60; 
        color: white;
        font-weight: bold;
        border: none;
    }
    .stTextInput>div>div>input { border-radius: 10px; }
    </style>
    """, unsafe_allow_html=True)

# --- 转专转 专砖转 ---
st.title(" SmartPantry")
st.subheader("驻 转 拽专专 砖 ")

# --- 住专 爪: 住转 驻转 API ---
api_key = st.sidebar.text_input("住 Google API Key:", type="password")
st.sidebar.markdown("[抓  爪转 驻转 ](https://aistudio.google.com/app/apikey)")

# --- 专 注转 转 ---
uploaded_file = st.file_uploader("爪  注 转 砖 拽专专/ 砖", type=["jpg", "jpeg", "png"])

if uploaded_file is not None:
    image = Image.open(uploaded_file)
    st.image(image, caption='转 砖爪', use_container_width=True)
    
    # --- 驻转专 驻注 ---
    if st.button('转 拽专专 爪注 转'):
        if not api_key:
            st.warning("拽砖 住 驻转 API 住专 爪  砖拽住 拽专")
        else:
            with st.spinner('-AI 住专拽 转 爪专 砖...  转'):
                try:
                    # 专 -Gemini
                    genai.configure(api_key=api_key)
                    model = genai.GenerativeModel('gemini-1.5-flash')
                    
                    #  -AI
                    prompt = """
                    转 转 转 砖 拽专专/:
                    1.  转  爪专  砖转 专转.
                    2. 爪专  砖 爪专 注 注专 砖   砖专 注 砖 转拽拽.
                    3. 转 2 转 爪专转, 注 驻砖 砖驻砖专  *专拽*  *注拽专* 注 爪专 砖转.
                    4. 住祝 驻 拽 住 .
                      转 注专转.
                    """
                    
                    response = model.generate_content([prompt, image])
                    
                    # 爪转 转砖
                    st.success("转 砖!")
                    st.markdown("###  转爪转 转:")
                    st.write(response.text)
                    
                except Exception as e:
                    st.error(f"驻住, 拽专转 砖: {str(e)}")

# --- 转转转 注 ---
st.markdown("---")
st.caption("SmartPantry MVP -  爪注转 Python -Gemini AI")